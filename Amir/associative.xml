<mydocument>
  <Elements>
    <Vt index="1"> 
	<G index="0">1</G> 
	<G index="1">0</G>
	<Group>G2</Group>
	<M>Vt5</M>
   	</Vt>

<!-- Input -->

	<R index="1">
	<G index="1">1</G>
	<G index="0">2</G>
	<Val>1.e4</Val>
	<Group>G2</Group>
    </R>

	<C index="1">
	<G index="1">1</G>
	<G index="2">2</G>
	<Val>15.e-10</Val>
    </C>

<!-- Channel One -->

	<R index="2">
	<G index="1">2</G>
	<G index="0">3</G>
	<Val>5.e3</Val>
	<Group>G2</Group>
    </R>

	<R index="3">
	<G index="1">3</G>
	<G index="0">4</G>
	<Val>24.e2</Val>
	<Group>G2</Group>
    </R>

    <CMS index="1">
	<G index="1">4</G>
	<G index="2">5</G>
	<M>Mem1</M>
	<Group>G2</Group>
    </CMS>	

	<R index="4">
	<G index="1">5</G>
	<G index="0">6</G>
	<Val>5.e1</Val>
	<Group>G2</Group>
    </R>

	<C index="2">
	<G index="1">3</G>
	<G index="2">0</G>
	<Val>16.e-10</Val>
    </C>


    <Vt index="2">
    <G index="1">0</G>
    <G index="0">6</G>
    <Group>G2</Group>
	<M>Vt2</M>    
	</Vt>

<!-- M2 Mott-->

    <R index="5">
	<G index="1">3</G>
	<G index="0">7</G>
	<Val>15.e3</Val>
	<Group>G2</Group>
    </R>

	<R index="6">
	<G index="1">7</G>
	<G index="0">8</G>
	<Val>24.e2</Val>
	<Group>G2</Group>
    </R>

    <CMS index="2">
	<G index="1">8</G>
	<G index="2">9</G>
	<M> Mem2</M>
	<Group>G2</Group>
    </CMS>	

	<R index="7">
	<G index="1">9</G>
	<G index="0">10</G>
	<Val>5.e1</Val>
	<Group>G2</Group>
    </R>

	<C index="3">
	<G index="1">7</G>
	<G index="2">0</G>
	<Val>50.e-11</Val>
    </C>

    <Vt index="3">
    <G index="1">10</G>
    <G index="0">0</G>
    <Group>G2</Group>
	<M>Vt2</M>    
	</Vt>

<!-- Output -->

	<R index="8">
	<G index="1">7</G>
	<G index="0">11</G>
	<Val>5.e4</Val>
	<Group>G2</Group>
    </R>

	<C index="4">
	<G index="1">7</G>
	<G index="2">11</G>
	<Val>15.e-10</Val>
    </C>
	
 	<R index="28">
	<G index="1">11</G>
	<G index="0">37</G>
	<Val>1.e0</Val>
	<Group>G2</Group>
    </R>

	<VMS index="1">
	<G index="1">12</G>
	<G index="0">37</G>
	<M>Mem4</M>
	<Group>G2</Group>
    </VMS>


 	<R index="9">
	<G index="1">12</G>
	<G index="0">13</G>
	<Val>1.e0</Val>
	<Group>G2</Group>
    </R>




<!--  **************************************************  -->

<!-- Input -->
<!--	<R index="27">
	<G index="1">13</G>
	<G index="0">38</G>
	<Val>1.e5</Val>
	<Group>G2</Group>
    </R>

	<C index="11">
	<G index="1">13</G>
	<G index="2">38</G>
	<Val>15.e-9</Val>
    </C>
-->
<!-- Channel One -->

	<R index="10">
	<G index="1">13</G>
	<G index="0">14</G>
	<Val>5.e3</Val>
	<Group>G2</Group>
    </R>

	<R index="11">
	<G index="1">14</G>
	<G index="0">15</G>
	<Val>24.e2</Val>
	<Group>G2</Group>
    </R>

    <CMS index="3">
	<G index="1">15</G>
	<G index="2">16</G>
	<M> Mem2</M>
	<Group>G2</Group>
    </CMS>	

	<R index="12">
	<G index="1">16</G>
	<G index="0">17</G>
	<Val>5.e1</Val>
	<Group>G2</Group>
    </R>

	<C index="4">
	<G index="1">14</G>
	<G index="2">0</G>
	<Val>16.e-10</Val>
    </C>


    <Vt index="4">
    <G index="1">0</G>
    <G index="0">17</G>
    <Group>G2</Group>
	<M>Vt2</M>    
	</Vt>

<!-- M2 Mott-->

    <R index="13">
	<G index="1">14</G>
	<G index="0">18</G>
	<Val>15.e3</Val>
	<Group>G2</Group>
    </R>

	<R index="14">
	<G index="1">18</G>
	<G index="0">19</G>
	<Val>24.e2</Val>
	<Group>G2</Group>
    </R>

    <CMS index="4">
	<G index="1">19</G>
	<G index="2">20</G>
	<M> Mem2</M>
	<Group>G2</Group>
    </CMS>	


	<R index="15">
	<G index="1">20</G>
	<G index="0">21</G>
	<Val>5.e1</Val>
	<Group>G2</Group>
    </R>

	<C index="5">
	<G index="1">18</G>
	<G index="2">0</G>
	<Val>50.e-11</Val>
    </C>

    <Vt index="5">
    <G index="1">21</G>
    <G index="0">0</G>
    <Group>G2</Group>
	<M>Vt2</M>    
	</Vt>

<!-- Output -->

	<R index="16">
	<G index="1">18</G>
	<G index="0">22</G>
	<Val>5.e4</Val>
	<Group>G2</Group>
    </R>

	<C index="6">
	<G index="1">18</G>
	<G index="2">22</G>
	<Val>15.e-10</Val>
    </C>

	<R index="17">
	<G index="1">22</G>
	<G index="0">23</G>
	<Val>1.e4</Val>
	<Group>G2</Group>
    </R>




<!--******************************************************************************
***********************************************************************************
**********************************************************************************-->
	


    <Vt index="6"> 
	<G index="0">24</G> 
	<G index="1">0</G>
	<Group>G2</Group>
	<M>Vt1</M>
   	</Vt>

<!-- Input -->

	<R index="18">
	<G index="1">24</G>
	<G index="0">25</G>
	<Val>1.e4</Val>
	<Group>G2</Group>
    </R>

	<C index="7">
	<G index="1">24</G>
	<G index="2">25</G>
	<Val>15.e-10</Val>
    </C>

<!-- Channel One -->

	<R index="19">
	<G index="1">25</G>
	<G index="0">26</G>
	<Val>5.e3</Val>
	<Group>G2</Group>
    </R>

	<R index="20">
	<G index="1">26</G>
	<G index="0">27</G>
	<Val>24.e2</Val>
	<Group>G2</Group>
    </R>

    <CMS index="5">
	<G index="1">27</G>
	<G index="2">28</G>
	<M> Mem2</M>
	<Group>G2</Group>
    </CMS>	

	<R index="21">
	<G index="1">28</G>
	<G index="0">29</G>
	<Val>5.e1</Val>
	<Group>G2</Group>
    </R>

	<C index="8">
	<G index="1">26</G>
	<G index="2">0</G>
	<Val>16.e-10</Val>
    </C>


    <Vt index="7">
    <G index="1">0</G>
    <G index="0">29</G>
    <Group>G2</Group>
	<M>Vt2</M>    
	</Vt>

<!-- M2 Mott-->

    <R index="22">
	<G index="1">26</G>
	<G index="0">30</G>
	<Val>15.e3</Val>
	<Group>G2</Group>
    </R>

	<R index="23">
	<G index="1">30</G>
	<G index="0">31</G>
	<Val>24.e2</Val>
	<Group>G2</Group>
    </R>

    <CMS index="6">
	<G index="1">31</G>
	<G index="2">32</G>
	<M> Mem2</M>
	<Group>G2</Group>
    </CMS>	


	<R index="24">
	<G index="1">32</G>
	<G index="0">33</G>
	<Val>5.e1</Val>
	<Group>G2</Group>
    </R>

	<C index="9">
	<G index="1">30</G>
	<G index="2">0</G>
	<Val>50.e-11</Val>
    </C>

    <Vt index="8">
    <G index="1">33</G>
    <G index="0">0</G>
    <Group>G2</Group>
	<M>Vt2</M>    
	</Vt>

<!-- Output -->

	<R index="25">
	<G index="1">30</G>
	<G index="0">34</G>
	<Val>5.e4</Val>
	<Group>G2</Group>
    </R>

	<C index="10">
	<G index="1">30</G>
	<G index="2">34</G>
	<Val>15.e-10</Val>
    </C>

	<R index="26">
	<G index="1">34</G>
	<G index="0">35</G>
	<Val>1.e0</Val>
	<Group>G2</Group>
    </R>
	
	<VMS index="2">
	<G index="1">36</G>
	<G index="0">35</G>
	<M>Mem3</M>
	<Group>G2</Group>
    </VMS>


 	<R index="27">
	<G index="1">36</G>
	<G index="0">12</G>
	<Val>1.e0</Val>
	<Group>G2</Group>
    </R>




  </Elements>

  <Models>
	<Vt1 name='Vt1'  V0 ='1.e0'>
		int ggqt;
		int ggqq;
		int ggqk;
		int ggqc;
		ggqt = t * 1.e10;
		val =0.;
			if(t>500.e-5){
			if(t>2500.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/400000;
		ggqc = ggqq * 4;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}				

			}	
		}
			if(t>5000.e-5){
			if(t>15000.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/400000;
		ggqc = ggqq * 4;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}				

			}	
		}
			if(t>17500.e-5){
			if(t>18500.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/400000;
		ggqc = ggqq * 4;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}				

			}	
		}			

	</Vt1>

	<Vt2 name='Vt2'  V0 ='1.' omega='1.e-1'>

val = 1.75;

	</Vt2>

	<Vt3 name='Vt3'  V0 ='1.' omega='1.e-1'>
		int ggqt;
		int ggqq;
		int ggqk;
		int ggqc;
		ggqt = t * 1.e10;
		if(t>4.e-6){
				val =0.;
			if(t>2000.e-5){
			if(t>3000.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/520000;
		ggqc = ggqq * 5;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}
			}	
		}
			if(t>4000.e-5){
			if(t>14000.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/520000;
		ggqc = ggqq * 5;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = -1.93;
			}
		}
			}	
		}
			if(t>15000.e-5){
			if(t>16000.e-5){
				val = 0.;
			}else{
				val = 1.5;
			}	
		}						
		}
		else{
			val = 0.;
		}

	</Vt3>


	<Vt4 name='Vt4'  V0 ='1.' omega='1.e-1'>

		if(t>0.){
				val =0.;
			if(t>1.e-5){
			if(t>295.e-5){
				val = 0.;
			}else{
				val = 0.9;
			}	
		}
			if(t>500.e-5){
			if(t>2000.e-5){
				val = 0.;
			}else{
				val = 0.9;
			}	
		}	
			if(t>2000.e-5){
			if(t>2500.e-5){
				val = 0.;
			}else{
				val = 0.9;
			}	
		}	
			if(t>2600.e-5){
			if(t>2700.e-5){
				val = 0.;
			}else{
				val = 0.9;
			}	
		}					
		}
		else{
			val = 0.;
		}
	</Vt4>
	<Vt5 name='Vt5'  V0 ='1.e0'>
		int ggqt;
		int ggqq;
		int ggqk;
		int ggqc;
		ggqt = t * 1.e10;
		val =0.;
			if(t>3000.e-5){
			if(t>4000.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/300000;
		ggqc = ggqq * 3;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}				

			}	
		}
			if(t>5000.e-5){
			if(t>15000.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/300000;
		ggqc = ggqq * 3;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}				

			}	
		}
			if(t>16000.e-5){
			if(t>17000.e-5){
				val = 0.;
			}else{
		ggqq = ggqt/300000;
		ggqc = ggqq * 3;
		ggqk = ggqc + 1;
		if(t > (ggqc*1.e-5)){
		if(t > (ggqk*1.e-5)){
			val = 0.;
		}
		else{
			val = 1.93;
			}
		}				

			}	
		}
	</Vt5>

	<Mem1 Q0='1.e-2' cp='2.6e6' dh='1.6e8' kap='0.9' met='3.e-4' ins='1.6e-2' tem='784e0' rch='3.e-8' ll='2.e-8' hh='1.e-10'>

	double Rch_I, Rch_II, Rch_W, dRch, Gth_W, dGth, dH_I, dH_II, dH_III, dH_W, ddH_I, ddH_II, ddH_III;

	if((-1*Omegaold_CM) > (-0.000001))
    {Omegaold_CM = 0.000001;
    }

    if(Omegaold_CM > 0.99999)
    {Omegaold_CM = 0.99999;
    }

    if((-1*Omegaxold_CM) > (-0.000001))
    {Omegaxold_CM = 0.000001;
    }

    if(Omegaxold_CM > 0.99999)
    {Omegaxold_CM = 0.99999;
    }
	
	Rch_I = ((ins * 2)/(M_PI * (3* rch)));
    Rch_II = 1.+(((ins / met)-1.) * (Omegaold_CM * Omegaold_CM));
    Rch_W = Rch_I / Rch_II;
    dRch = 2. * (((ins/met)-1.)*M_PI*(rch*3)*(Un_CM * Un_CM)*Omegaold_CM)/(ins * 2);

    Gth_W =-2.*M_PI*ll*kap/log(Omegaold_CM);
    dGth = -2.*M_PI*ll*kap*tem/(Omegaold_CM*(log(1./Omegaold_CM)*log(1./Omegaold_CM)));

    dH_I = M_PI*ll*rch*rch;
    dH_II = cp*tem*((1. - (Omegaold_CM*Omegaold_CM ) + (2.*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)))/(4.*Omegaold_CM*Omegaold_CM*(log(Omegaold_CM)*log(Omegaold_CM))));
    dH_III = 2. * dh * Omegaold_CM;
    dH_W = dH_I * (dH_II + dH_III);
    ddH_I = 2. *cp * tem / (Omegaold_CM*log(Omegaold_CM));
    ddH_II = -1.*cp*tem*(1.-(Omegaold_CM*Omegaold_CM )+(2.*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)))/(2.*Omegaold_CM*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)*log(Omegaold_CM)*log(Omegaold_CM));
    ddH_III = -1.*cp*tem*(1.-(Omegaold_CM*Omegaold_CM )+(2.*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)))/(2.*Omegaold_CM*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)*log(Omegaold_CM));

    Fwv =(2*(Omegaold_CM-Omegaxold_CM)/hh)-(1.e0*((((Un_CM*Un_CM)/Rch_W)-(Gth_W*tem))/dH_W));
    Jw = (2/hh)+1.e0*(((((Un_CM*Un_CM)/Rch_W)-(Gth_W*tem))*((2.*dh)+ddH_I+ddH_II+ddH_III))/(dH_I*((dH_II + dH_III)*(dH_II + dH_III))))-(1.e0*((dRch+dGth)/dH_W));
    Jv = (-2.*Un_CM)/(dH_W*Rch_W);	
	RR = Rch_W;
	Ki_CM = Fwv/(-1*Jw);
	Kpi_CM = Jv/Jw;
	Kv_CM = (dRch/(Rch_W*Rch_W))*(Ki_CM);
	Kpv_CM = (dRch/(Rch_W*Rch_W))*(Kpi_CM);
	</Mem1>
	<Mem2 Q0='1.e-2' cp='2.6e6' dh='1.6e8' kap='0.9' met='3.e-4' ins='1.6e-2' tem='784e0' rch='3.e-8' ll='2.e-8' hh='1.e-10'>

	if((-1*Omegaold_CM) > (-0.000001))
    {Omegaold_CM = 0.000001;
    }

    if(Omegaold_CM > 0.99999)
    {Omegaold_CM = 0.99999;
    }

    if((-1*Omegaxold_CM) > (-0.000001))
    {Omegaxold_CM = 0.000001;
    }

    if(Omegaxold_CM > 0.99999)
    {Omegaxold_CM = 0.99999;
    }
	
	Rch_I = ((ins * 2)/(M_PI * (3* rch)));
    Rch_II = 1.+(((ins / met)-1.) * (Omegaold_CM * Omegaold_CM));
    Rch_W = Rch_I / Rch_II;
    dRch = 2. * (((ins/met)-1.)*M_PI*(rch*3)*(Un_CM * Un_CM)*Omegaold_CM)/(ins * 2);

    Gth_W =-2.*M_PI*ll*kap/log(Omegaold_CM);
    dGth = -2.*M_PI*ll*kap*tem/(Omegaold_CM*(log(1./Omegaold_CM)*log(1./Omegaold_CM)));

    dH_I = M_PI*ll*rch*rch;
    dH_II = cp*tem*((1. - (Omegaold_CM*Omegaold_CM ) + (2.*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)))/(4.*Omegaold_CM*Omegaold_CM*(log(Omegaold_CM)*log(Omegaold_CM))));
    dH_III = 2. * dh * Omegaold_CM;
    dH_W = dH_I * (dH_II + dH_III);
    ddH_I = 2. *cp * tem / (Omegaold_CM*log(Omegaold_CM));
    ddH_II = -1.*cp*tem*(1.-(Omegaold_CM*Omegaold_CM )+(2.*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)))/(2.*Omegaold_CM*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)*log(Omegaold_CM)*log(Omegaold_CM));
    ddH_III = -1.*cp*tem*(1.-(Omegaold_CM*Omegaold_CM )+(2.*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)))/(2.*Omegaold_CM*Omegaold_CM*Omegaold_CM*log(Omegaold_CM)*log(Omegaold_CM));

    Fwv =(2*(Omegaold_CM-Omegaxold_CM)/hh)-(1.e0*((((Un_CM*Un_CM)/Rch_W)-(Gth_W*tem))/dH_W));
    Jw = (2/hh)+1.e0*(((((Un_CM*Un_CM)/Rch_W)-(Gth_W*tem))*((2.*dh)+ddH_I+ddH_II+ddH_III))/(dH_I*((dH_II + dH_III)*(dH_II + dH_III))))-(1.e0*((dRch+dGth)/dH_W));
    Jv = (-2.*Un_CM)/(dH_W*Rch_W);	
	RR = Rch_W;
	Ki_CM = Fwv/(-1*Jw);
	Kpi_CM = Jv/Jw;
	Kv_CM = (dRch/(Rch_W*Rch_W))*(Ki_CM);
	Kpv_CM = (dRch/(Rch_W*Rch_W))*(Kpi_CM);
	</Mem2>

	<Mem3 Phi0='74.e3' hh='1.e-8' alpha='0' beta='15.e8' tresh='0.55' r1='1000' r2='74000'>


		if((-1*Omegaold_M) > (-1*r1))
			{Omegaold_M = r1;
		}
		if(Omegaold_M > r2)
			{Omegaold_M = r2;
		}
		if((-1*Omegaxold_M) > (-1*r1))
			{Omegaxold_M = r1;
		}
		if(Omegaxold_M > r2)
			{Omegaxold_M = r2;
		}
		
		Jw = (1/1);
    Jv = 1*hh*beta;
    Fwv = Omegaold_M + ((Omegaxold_M)/-1) - hh *(beta * Un_VM + (0.5*(alpha - beta)) * (abs(Un_VM + tresh) - abs(Un_VM - tresh)));
    Kv_VM = Un_VM /Omegaold_M;
    Kpv_VM = (1/Omegaold_M);		
	</Mem3>
	<Mem4 Phi0='7000' hh='1.e-8' alpha='0' beta='15.e7' tresh='0.5' r1='7000' r2='10000'>
	  double Kv_VM, Kpv_VM;
		if((-1*Omegaold_M) > (-1*r1))
			{Omegaold_M = r1;
		}
		if(Omegaold_M > r2)
			{Omegaold_M = r2;
		}
		if((-1*Omegaxold_M) > (-1*r1))
			{Omegaxold_M = r1;
		}
		if(Omegaxold_M > r2)
			{Omegaxold_M = r2;
		}
		
		Jw = (1/1);
    Jv = 1*hh*beta;
    Fwv = Omegaold_M + ((Omegaxold_M)/-1) - hh *(beta * Un_VM + (0.5*(alpha - beta)) * (abs(Un_VM + tresh) - abs(Un_VM - tresh)));
    Kv_VM = Un_VM /Omegaold_M;
    Kpv_VM = (1/Omegaold_M);		
	</Mem4>




  </Models>

 <Simulations>
    <DC_Dynamic 
            start="0.0" 
            step="1.e-8" 
            end="185.e-3"
            output="result/Hebbian"
            output_rate ="100"
            method ="klu">
            2
    </DC_Dynamic>

</Simulations>
 
  
</mydocument>

